<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>PSMStatistics</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="David Zimmer, Jonathan Ott, Heinrich Lukas Weil, Timo Muehlhaus">
    <link rel="shortcut icon" type="image/x-icon" href="https://csbiology.github.io/ProteomIQon//img/favicon.ico">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> -->

    <link type="text/css" rel="stylesheet" href="https://csbiology.github.io/ProteomIQon/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="https://csbiology.github.io/ProteomIQon/content/fsdocs-custom.css" />
    <script type="text/javascript" src="https://csbiology.github.io/ProteomIQon/content/fsdocs-tips.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-collapsible@1.0.4/dist/js/bulma-collapsible.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-collapsible@1.0.4/dist/css/bulma-collapsible.min.css">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head> 

<body>
    <div class="columns is-fullheight m-0">
        <div id="fsdocs-menu" class="column is-2 is-paddingless">
            <aside class="menu">
                <div class="container is-paddingless is-marginless has-background-dark">
                    <a href="https://csbiology.github.io/ProteomIQon/">
                        <figure class="image is-128x128 container">
                            <img src="https://csbiology.github.io/ProteomIQon/img/logo.png">
                        </figure>
                    </a>
                    <h2 class="title has-text-centered has-text-white pb-4">ProteomIQon</h2>
                </div>
                <div class="content">
                    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
                    <div id="header">
                        <div class="field">
                            <div class="control has-icons-left has-icons-right searchbox" id="fsdocs-searchbox">
                                <input data-search-input="" id="search-by" type="search" placeholder="Search..." class="input"/>
                                <span class="icon is-small is-left">
                                    <i class="fas fa-search"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <!-- END SEARCH BOX: this adds support for the search box -->
                    <ul class="navbar-nav">
                        <li class="nav-header">General</li>
                        <li class="nav-item"><a href="/ProteomIQon">Home</a></li>
                        <li class="nav-header">
  Tools
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/tools/MzMLToMzLite.html">
    MzMLToMzLite
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/tools/PeptideDB.html">
    PeptideDB
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/tools/PeptideSpectrumMatching.html">
    PeptideSpectrumMatching
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/tools/PSMStatistics.html">
    PSMStatistics
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/tools/PSMBasedQuantification.html">
    PSMBasedQuantification
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/tools/ProteinInference.html">
    ProteinInference
  </a>
</li>             
<li class="nav-header">
  Developer Notes
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/develop/How_to_create_a_tool.html">
    How to create your own tool
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/develop/How_to_document_your_work.html">
    How to document your work
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://csbiology.github.io/ProteomIQon/develop/How_to_build_binaries_or_packages.html">
    How to build binaries or packages
  </a>
</li>
                        <li class="nav-header">Powered By</li>
                        <li class="nav-item"><a href="https://github.com/CSBiology/MzIO">MzIO</a></li>
                        <li class="nav-item"><a href="https://github.com/CSBiology/BioFSharp">BioFSharp</a></li>
                        <li class="nav-item"><a href="https://github.com/CSBiology/BioFSharp.Mz">BioFSharp.Mz</a></li>
                        <li class="nav-item"><a href="https://github.com/fslaborg/FSharp.Stats">FSharp.Stats</a></li>
                        <li class="nav-item"><a href="https://github.com/fslaborg/Deedle">Deedle</a></li>
                        <li class="nav-item"><a href="https://fsharp.org">FSharp</a></li>
                    </ul>
                </div>
            </aside>
        </div>
        <div class="column is-10 is-paddingless">
            <div class="section pt-4">
                <div class="container" id="fsdocs-content">
                    
<p><a href="https://mybinder.org/v2/gh/csbiology/ProteomIQon/gh-pages?filepath=tools/PSMStatistics.ipynb"><img src="https://csbiology.github.io/ProteomIQon/img/badge-binder.svg" alt="Binder" /></a>&emsp;
<a href="https://csbiology.github.io/ProteomIQon/tools/PSMStatistics.fsx"><img src="https://csbiology.github.io/ProteomIQon/img/badge-script.svg" alt="Script" /></a>&emsp;
<a href="https://csbiology.github.io/ProteomIQon/tools/PSMStatistics.ipynb"><img src="https://csbiology.github.io/ProteomIQon/img/badge-notebook.svg" alt="Notebook" /></a></p>
<h1><a name="Peptide-Spectrum-Matching-Statistics" class="anchor" href="#Peptide-Spectrum-Matching-Statistics">Peptide Spectrum Matching Statistics</a></h1>
<p><strong>Disclaimer</strong> this tool relies on the output of the tools <a href="https://csbiology.github.io/ProteomIQon/tools/peptideDb.html">PeptideDB</a> and <a href="https://csbiology.github.io/ProteomIQon/tools/PeptideSpectrumMatching.html">PeptideSpectrumMatching</a>.</p>
<p>An established method to identify acquired MS/MS spectra is the <a href="https://csbiology.github.io/ProteomIQon/tools/PeptideSpectrumMatching.html">comparison</a> of each spectrum with peptides in a <a href="https://csbiology.github.io/ProteomIQon/tools/peptideDb.html">reference database</a>.</p>
<p>To measure the similarity of in silico generated spectra and measured MS/MS scans we use our own implementations of three established search enginge scores: SEQUEST, Andromeda and XTandem.
Additionally, we also record quality control parameters such as the mass difference between the precursor ion and the theoretically calulated mass or the uniquness of each score in comparison to 'competing'
peptides within the search space. The PSMStatistics tool utilizes semi supervised machine learning techniques to integrate search engine scores as well as the mentioned quality scores into one single consensus score.</p>
<img src="https://csbiology.github.io/ProteomIQon/img/SemiSupervisedScoring.png" width="1000" height="750" />
<p>Since the search space is extended by so called decoys - reversed counterparts of peptides within the search space - we can estimate the distribution of 'true negatives' and calculate local (PEP values) and global (Q values)
false discovery rates at each consensus score.
The reported peptides at user defined local and global FDR cutoffs can then be used as inputs for any downstream analysis be it <a href="https://csbiology.github.io/ProteomIQon/tools/ProteinInference.html">ProteinInference</a> or <a href="https://csbiology.github.io/ProteomIQon/tools/PSMBasedQuantification.html">PSMBasedQuantification</a></p>
<h2><a name="Parameters" class="anchor" href="#Parameters">Parameters</a></h2>
<p>The following table gives an overview of the parameter set:</p>
<table>
<thead>
<tr class="header">
<th><p><strong>Parameter</strong></p></th>
<th><p><strong>Default Value</strong></p></th>
<th><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Threshold</p></td>
<td><p>Threshold.Estimate {QValueThreshold = 0.01; PepValueThreshold = 0.05;MaxIterations=15;MinimumIncreaseBetweenIterations=0.005; PepValueFittingMethod = LinearLogit}</p></td>
<td><p>Parameters used for FDR based filtering of scored peptides</p></td>
</tr>
<tr class="even">
<td><p>ParseProteinIDRegexPattern</p></td>
<td><p>id</p></td>
<td><p>Regex pattern for parsing of the protein IDs in the database</p></td>
</tr>
<tr class="odd">
<td><p>KeepTemporaryFiles</p></td>
<td><p>false</p></td>
<td><p>Indicates if temporary files should be kept or discarded</p></td>
</tr>
</tbody>
</table>

<h2><a name="Parameter-Generation" class="anchor" href="#Parameter-Generation">Parameter Generation</a></h2>
<p>Parameters are handed to the cli tool as a .json file. you can download the default file <a href="https://github.com/CSBiology/ProteomIQon/blob/master/src/ProteomIQon/defaultParams/psmstatisticsparams.json">here</a>,
or use an F# script, which can be downloaded or run in Binder at the top of the page, to write your own parameter file:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="pp">#r</span> <span class="s">&quot;nuget: BioFSharp.Mz, 0.1.5-beta&quot;</span>
<span class="pp">#r</span> <span class="s">&quot;nuget: ProteomIQon, 0.0.6&quot;</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">ProteomIQon</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 2)" onmouseover="showTip(event, 'fs1', 2)" class="id">ProteomIQon</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="m">Domain</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="id">BioFSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="id">Mz</span>


<span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="id">defaultPSMStatistics</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="m">Dto</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="id">PSMStatisticsParams</span> <span class="o">=</span> 
    <span class="pn">{</span>
        <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="prop">Threshold</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="rt">Threshold</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="id">Estimate</span> <span class="pn">{</span><span class="prop">QValueThreshold</span> <span class="o">=</span> <span class="n">0.01</span><span class="pn">;</span> <span class="prop">PepValueThreshold</span> <span class="o">=</span> <span class="n">0.05</span><span class="pn">;</span><span class="prop">MaxIterations</span><span class="o">=</span><span class="n">15</span><span class="pn">;</span><span class="prop">MinimumIncreaseBetweenIterations</span><span class="o">=</span><span class="n">0.005</span><span class="pn">;</span> <span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="prop">PepValueFittingMethod</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="uc">LinearLogit</span><span class="pn">}</span>
        <span class="prop">ParseProteinIDRegexPattern</span>  <span class="o">=</span> <span class="s">&quot;id&quot;</span>
        <span class="prop">KeepTemporaryFiles</span>          <span class="o">=</span> <span class="k">true</span>
    <span class="pn">}</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="id">serialized</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="id">defaultPSMStatistics</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="m">Json</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="id">serialize</span>
</code></pre>
<h2><a name="Executing-the-Tool" class="anchor" href="#Executing-the-Tool">Executing the Tool</a></h2>
<p><strong>Disclaimer</strong> this tool relies on the output of the tools <a href="https://csbiology.github.io/ProteomIQon/tools/peptideDb.html">PeptideDB</a> and <a href="https://csbiology.github.io/ProteomIQon/tools/PeptideSpectrumMatching.html">PeptideSpectrumMatching</a>.</p>
<p>To rescore all MS/MS to identify 'true' psms call:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">proteomiqon</span><span class="o">-</span><span class="id">psmstatistics</span> <span class="o">-</span><span class="id">i</span> <span class="s">&quot;path/to/your/run.psm&quot;</span> <span class="o">-</span><span class="id">d</span> <span class="s">&quot;path/to/your/database.sqlite&quot;</span> <span class="o">-</span><span class="id">o</span> <span class="s">&quot;path/to/your/outDirectory&quot;</span> <span class="o">-</span><span class="id">p</span> <span class="s">&quot;path/to/your/params.json&quot;</span>
</code></pre>
<p>It is also possible to call the tool on a list of .psm files. If you have a mulitcore cpu it is possible to rescore multiple runs in parallel using the -c flag:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">proteomiqon</span><span class="o">-</span><span class="id">psmstatistics</span> <span class="o">-</span><span class="id">i</span> <span class="s">&quot;path/to/your/run1.psm&quot;</span> <span class="s">&quot;path/to/your/run2.psm&quot;</span> <span class="s">&quot;path/to/your/run3.psm&quot;</span> <span class="o">-</span><span class="id">d</span> <span class="s">&quot;path/to/your/database.sqlite&quot;</span> <span class="o">-</span><span class="id">o</span> <span class="s">&quot;path/to/your/outDirectory&quot;</span> <span class="o">-</span><span class="id">p</span> <span class="s">&quot;path/to/your/params.json&quot;</span> <span class="o">-</span><span class="id">c</span> <span class="n">3</span>
</code></pre>
<p>To create diagnostic plots which show the performance of the psm scorer after a iteration, you can specify the -dc flag:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">proteomiqon</span><span class="o">-</span><span class="id">psmstatistics</span> <span class="o">-</span><span class="id">i</span> <span class="s">&quot;path/to/your/run1.psm&quot;</span> <span class="s">&quot;path/to/your/run2.psm&quot;</span> <span class="s">&quot;path/to/your/run3.psm&quot;</span> <span class="o">-</span><span class="id">d</span> <span class="s">&quot;path/to/your/database.sqlite&quot;</span> <span class="o">-</span><span class="id">o</span> <span class="s">&quot;path/to/your/outDirectory&quot;</span> <span class="o">-</span><span class="id">p</span> <span class="s">&quot;path/to/your/params.json&quot;</span> <span class="o">-</span><span class="id">c</span> <span class="n">3</span> <span class="o">-</span><span class="id">dc</span>
</code></pre>
<p>A detailed description of the CLI arguments the tool expects can be obtained by calling the tool:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="id">proteomiqon</span><span class="o">-</span><span class="id">psmstatistics</span> <span class="pn">--</span><span class="id">help</span>
</code></pre>

                </div>
            </div>
        </div>
        <div class="fsdocs-tip" id="fs1">namespace ProteomIQon</div>
<div class="fsdocs-tip" id="fs2">module Domain<br /><br />from ProteomIQon</div>
<div class="fsdocs-tip" id="fs3">namespace BioFSharp</div>
<div class="fsdocs-tip" id="fs4">namespace BioFSharp.Mz</div>
<div class="fsdocs-tip" id="fs5">val defaultPSMStatistics : Dto.PSMStatisticsParams</div>
<div class="fsdocs-tip" id="fs6">module Dto<br /><br />from ProteomIQon</div>
<div class="fsdocs-tip" id="fs7">Multiple items<br />module PSMStatisticsParams<br /><br />from ProteomIQon.Dto<br /><br />--------------------<br />type PSMStatisticsParams =<br />&#160;&#160;{ Threshold: Threshold<br />&#160;&#160;&#160;&#160;ParseProteinIDRegexPattern: string<br />&#160;&#160;&#160;&#160;KeepTemporaryFiles: bool }</div>
<div class="fsdocs-tip" id="fs8">type Threshold =<br />&#160;&#160;| Estimate of EstimationParams<br />&#160;&#160;| Fixed of ScoreCutoff</div>
<div class="fsdocs-tip" id="fs9">union case Threshold.Estimate: EstimationParams -&gt; Threshold</div>
<div class="fsdocs-tip" id="fs10">type PepValueFittingMethod = | LinearLogit</div>
<div class="fsdocs-tip" id="fs11">union case PepValueFittingMethod.LinearLogit: PepValueFittingMethod</div>
<div class="fsdocs-tip" id="fs12">val serialized : string</div>
<div class="fsdocs-tip" id="fs13">module Json<br /><br />from ProteomIQon</div>
<div class="fsdocs-tip" id="fs14">val serialize : obj:&#39;a -&gt; string</div>

    </div>

    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <script type="text/javascript">var fsdocs_search_baseurl = 'https://csbiology.github.io/ProteomIQon/'</script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
    <script type="text/javascript" src="https://csbiology.github.io/ProteomIQon/content/fsdocs-search.js"></script>
    <!-- END SEARCH BOX: this adds support for the search box -->
</body>
<footer>
    <script>
        bulmaCollapsible.attach('.is-collapsible');
    </script>
</footer>
</html>